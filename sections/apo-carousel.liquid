{{ 'carousel.css' | asset_url | stylesheet_tag }}

<script src='{{ 'carousel.js' | asset_url }}' defer='defer'></script>

{% if section.blocks != blank %}
  <div class='carousel'>
    <button class='carousel-button prev'>&lt;</button>
    <button class='carousel-button next'>&gt;</button>
    <div class='carousel-slide'>
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'image_carousel' %}
            {% unless block.settings.image == blank %}
              {% assign image = block.settings.image %}

              <div class='carousel-image'>
                {% if block.settings.url %}
                  <a
                    href='{{ block.settings.url }}'
                    target='_blank'
                    rel='noopener noreferrer'
                  >
                    <img
                      srcset='
                        {%- if image.width >= 165 -%}{{ image | image_url: width: 165 }} 165w,{%- endif -%}
                        {%- if image.width >= 360 -%}{{ image | image_url: width: 360 }} 360w,{%- endif -%}
                        {%- if image.width >= 533 -%}{{ image | image_url: width: 533 }} 533w,{%- endif -%}
                        {%- if image.width >= 720 -%}{{ image | image_url: width: 720 }} 720w,{%- endif -%}
                        {%- if image.width >= 940 -%}{{ image | image_url: width: 940 }} 940w,{%- endif -%}
                        {%- if image.width >= 1066 -%}{{ image | image_url: width: 1066 }} 1066w,{%- endif -%}
                        {{ image | image_url }} {{ image.width }}w
                      '
                      src='{{ image | image_url: width: 2000 }}'
                      alt='{{ image.alt }}'
                      loading='lazy'
                    >
                  </a>
                {% else %}
                  <img
                    srcset='
                      {%- if image.width >= 165 -%}{{ image | image_url: width: 165 }} 165w,{%- endif -%}
                      {%- if image.width >= 360 -%}{{ image | image_url: width: 360 }} 360w,{%- endif -%}
                      {%- if image.width >= 533 -%}{{ image | image_url: width: 533 }} 533w,{%- endif -%}
                      {%- if image.width >= 720 -%}{{ image | image_url: width: 720 }} 720w,{%- endif -%}
                      {%- if image.width >= 940 -%}{{ image | image_url: width: 940 }} 940w,{%- endif -%}
                      {%- if image.width >= 1066 -%}{{ image | image_url: width: 1066 }} 1066w,{%- endif -%}
                      {{ image | image_url }} {{ image.width }}w
                    '
                    src='{{ image | image_url: width: 2000 }}'
                    alt='{{ image.alt }}'
                    loading='lazy'
                  >
                {% endif %}
              </div>
            {% endunless %}
        {% endcase %}
      {% endfor %}
    </div>
    <div class='dot-container'></div>
  </div>
{% endif %}

{% schema %}
{
  "name": "圖片幻燈片",
  "tag": "section",
  "settings": [],
  "blocks": [
    {
      "name": "圖片",
      "type": "image_carousel",
      "settings": [
        {
          "id": "image",
          "type": "image_picker",
          "label": "選擇圖片"
        },
        {
          "id": "url",
          "type": "url",
          "label": "選擇頁面（若無則為無連結的圖片）"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "圖片幻燈片123"
    }
  ]
}
{% endschema %}
